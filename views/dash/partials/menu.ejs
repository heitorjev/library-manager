<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

<aside class="sidebar">
    <div class="logo">
        <i class="ri-book-open-line"></i>
        <span>BiblioTech</span>
    </div>
    <nav>
        <ul class="menu">
            <li class="menu-item">
                <a onclick="navigate('/dash')" class="menu-link <%= currentPath === '/dash' ? 'active' : '' %>">
                    <i class="ri-dashboard-line"></i>
                    <span>Dashboard</span>
                </a>
            </li>
            <li class="menu-item">
                <a onclick="navigate('/dash/books')" class="menu-link <%= currentPath.includes('/books') ? 'active' : '' %>">
                    <i class="ri-book-2-line"></i>
                    <span>Livros</span>
                </a>
            </li>
            <li class="menu-item">
                <a onclick="navigate('/dash/users')" class="menu-link <%= currentPath.includes('/users') ? 'active' : '' %>">
                    <i class="ri-user-line"></i>
                    <span>Usuários</span>
                </a>
            </li>
            <li class="menu-item">
                <a onclick="navigate('/dash/loans')" class="menu-link <%= currentPath === '/dash/loans' ? 'active' : '' %>">
                    <i class="ri-exchange-funds-line"></i>
                    <span>Empréstimos</span>
                </a>
            </li>
        </ul>
    </nav>
    <div class="user-info">
        <div class="user-avatar"><%= user.firstLetters %></div>
        <button class="user-menu-toggle" id="user-menu-toggle">
            <span class="user-name"><%= user.name %></span>
            <i class="ri-arrow-down-s-line"></i>
        </button>
        <div class="user-dropdown" id="user-dropdown">
            <a href="/dash/profile" class="user-dropdown-item">
                <i class="ri-user-settings-line"></i>
                Gerenciar Perfil
            </a>
            <a href="/auth/logout" class="user-dropdown-item">
                <i class="ri-logout-box-r-line"></i>
                Sair
            </a>
        </div>
    </div>
</aside>

<script>
function navigate(url) {
    window.location.href = url;
}

// Adicionar controle do menu mobile
document.addEventListener('DOMContentLoaded', function() {
    const userMenuToggle = document.getElementById('user-menu-toggle');
    const userDropdown = document.getElementById('user-dropdown');
    
    userMenuToggle.addEventListener('click', function() {
        userDropdown.classList.toggle('open');
    });

    // Fechar dropdown ao clicar fora
    document.addEventListener('click', function(e) {
        if (!userMenuToggle.contains(e.target) && !userDropdown.contains(e.target)) {
            userDropdown.classList.remove('open');
        }
    });
});

// Controle do menu mobile
function toggleMobileMenu() {
    document.querySelector('.sidebar').classList.toggle('open');
    document.querySelector('.menu-toggle').classList.toggle('open');
}
</script>